<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caixa de Mensagem</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <link rel="stylesheet" href="/css/messageScreen.css">
</head>

<body>
<div id="app">
    <div class="profile-icon" @click="toggleMenu"> <img src="/css/png/icone.png" alt="icon" height="50px"></div>
    <div class="menu-container" :class="{ 'active': isMenuOpen }">
        <ul>
            <li @click="redirectTo('/floricultura/mensagem')"><a ><strong>Menu Principal</strong></a></li>
            <li @click="redirectTo('/floricultura/ver-flores')"><a ><strong>Ver Flores</strong></a></li>
            <li @click="redirectTo('/floricultura/perfil')"><a ><strong>informações do perfil</strong></a></li>
            <li @click="redirectTo('/floricultura/sobre-Nos')"><a ><strong>Sobre nós</strong></a></li>
            <li @click="redirectTo('/floricultura/logout')"><a ><strong>Sair</strong></a></li>
        </ul>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<script src="/js/screenPrincipal.js"></script>
<div class="caixa-mensagem">
    <form id="formulario">
        <input class="input" type="text" id="assunto" autocomplete="off" name="text" placeholder="Digite o assunto">
        <br>
        <input class="input" type="text" id="email" autocomplete="off" name="text" placeholder="Email">
        <textarea id="mensagem" class="input" autocomplete="off" name="text"
                  placeholder="Digite sua mensagem"></textarea>
    </form>


    <button onclick="enviarMensagem()">Enviar</button>
</div>

<footer></footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<script>
        function enviarMensagem() {
            var assunto = document.getElementById('assunto').value;
            var email = document.getElementById('email').value;
            var mensagem = document.getElementById('mensagem').value;

            var data = {
                assunto: assunto,
                email: email,
                mensagem: mensagem
            };

            fetch('/api/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(function (response) {
                    if (response.ok) {
                        // Email enviado com sucesso
                        Swal.fire({
                            icon: 'success',
                            title: 'Email enviado com sucesso!',
                            showConfirmButton: false,
                            timer: 1500
                        });

                        // Limpar os campos do formulário
                        document.getElementById('assunto').value = '';
                        document.getElementById('email').value = '';
                        document.getElementById('mensagem').value = '';
                    } else {
                        // Lidar com erros de envio do email
                        Swal.fire({
                            icon: 'error',
                            title: 'Erro ao enviar o email!',
                            text: 'Por favor, tente novamente mais tarde.',
                            showConfirmButton: false,
                            timer: 2000
                        });
                    }
                })
                .catch(function (error) {
                    console.error('Erro durante a solicitação:', error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Erro durante a solicitação!',
                        text: 'Por favor, tente novamente mais tarde.',
                        showConfirmButton: false,
                        timer: 2000
                    });
                });
        }
    </script>
</body>

</html>
